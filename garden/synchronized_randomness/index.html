<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><script data-goatcounter=https://wegold.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;400;600;700;800&family=Frank+Ruhl+Libre:wght@200;300;400;500;600&family=Encode+Sans+Semi+Condensed:wght@400&display=swap" rel=stylesheet><link rel=stylesheet type=text/css href=/css/bootstrap.min.css><link rel=stylesheet type=text/css href=/css/all.min.css><link disabled id=dark-mode-theme rel=stylesheet href=/css/dark.css><link rel=stylesheet type=text/css href=/css/style.css><link rel=stylesheet type=text/css href=/css/custom.css><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon type=image/x-icon href=/favicon.ico><title>Weaver Goldman | Creating synchronized randomness</title><meta name=description content="Using web technologies and math to synchronize random numbers without the need for a server."></head><body><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class=container><a class=navbar-brand href=https://we-gold.github.io><b style=font-weight:800>WG</b></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNavDropdown aria-controls=navbarNavDropdown aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavDropdown><ul class="navbar-nav ms-auto mt-2 mt-lg-0"><li class=nav-item><a class=nav-link href=/garden/>Digital Garden</a></li><li class=nav-item><a class=nav-link href=/projects/>Projects</a></li><li class=nav-item><a class=nav-link href=/about/>About</a></li><li class="nav-item px-2 pt-1"><a class="btn fas fa-moon" id=dark-mode-toggle></a></li></ul></div></div></nav><div id=content><div class=container style=max-width:800px><div class="py-4 rounded-3"><div class="container-fluid py-2"><h1 class="display-2 mb-4 text-center">Creating synchronized randomness</h1></div><p class="text-center fs-4 fst-italic serif">Using web technologies and math to synchronize random numbers without the need for a server.</p><div class="text-center pt-4"></div></div><div class="row justify-content-center mb-5"><div class=col-12><p class="card-date m-0">Created Jun 22, 2022 -
Last updated: Jun 22, 2022</p><hr class=dropdown-divider><div class="row justify-content-between"><div class=col-sm-4><span class=status>Seeding ðŸŒ±</span></div><div class=col-sm-8 style=text-align:right><span class="badge tag-badge">math</span>
<span class="badge tag-badge">web</span></div></div></div></div><div class="container-fluid py-2"><div class="serif main-content"><p>In my recent project, <a href=https://github.com/We-Gold/identity>Identity</a>, I created an entirely unnecessary problem.</p><hr><p>Identity is an app that allows you to configure a custom clock screen with unique animations (but with bigger long-term goals for more personalized graphics).</p><p>During the brainstorming phase, I decided that it would be absolutely crucial for the central clock animation to be synchronized across all devices.</p><p>That led me down a long rabbit-hole of math, time, and incomplete solutions. In the end, the solution I came up with is sufficient for small projects, but not professional level applications. Still, the ideas are interesting, so I&rsquo;ll present the algorithm here.</p><h2 id=the-components>The Components</h2><p>There are only three parts of this algorithm, and here I will attempt to explain them as simply as possible.</p><h4 id=a-seeded-number-generator>A Seeded Number Generator</h4><p>When generating random numbers on a computer, we use pseudo-random number generators to generate random numbers. The cool thing about these generators is that they can be &ldquo;seeded&rdquo;.</p><p>A random number generator that has been seeded (typically with a numeric value) will always produce the same sequence of random numbers.</p><p>Such a generator would allow us to create &ldquo;the same&rdquo; random number generator on all devices.</p><p>Unfortunately, because the app will likely never be opened at exactly the same time on multiple devices, these number generators are immediately out of sync with each other.</p><h4 id=simplex-noise-sometimes-called-perlin-noise>Simplex Noise (sometimes called Perlin Noise)</h4><p>Simplex noise is much <em>simpler</em> (pun intended) than the name would suggest.</p><p>It is an algorithm that allows us to generate a smooth topographical map of random numbers with an arbitrary number of dimensions.</p><p>Here is an example of what a 2D Simplex Noise map would look like (each pixel is a number between -1 and 1).</p><figure><img src=../images/simplex%20noise.png width=100%></figure><p>So how exactly does this help us?</p><h4 id=the-time-component>The Time Component</h4><p>Time is what brings together this entire algorithm. <em>Unfortunately that does mean that the synchronicity of this solution depends on using a consistent timestamp, so be aware of that while implementing the algorithm.</em></p><p>Let&rsquo;s say that you want to generate a random map like the one above, but you want it to change with time while being synchronized across devices.</p><p>For this, we will need a 3-dimensional simplex noise map, with two dimensions for x and y, and one for time.</p><p>This way, on every render loop, we can get a noise map that is unique to the current timestamp.</p><p>In my project, I used the <code>Date.now()</code> function to get the current timestamp (in ms), but you may want to consider a more developed time library for your own application.</p><h2 id=basic-javascript-code>Basic JavaScript Code</h2><p>The implementation I wrote is very short and simple, and it uses two small JS libraries: <a href=https://www.npmjs.com/package/fast-simplex-noise>fast-simplex-noise</a> and <a href=https://www.npmjs.com/package/rand-seed>rand-seed</a>.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#00a8c8>import</span> <span style=color:#111>{</span> <span style=color:#75af00>makeNoise3D</span> <span style=color:#111>}</span> <span style=color:#75af00>from</span> <span style=color:#d88200>&#34;fast-simplex-noise&#34;</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>import</span> <span style=color:#75af00>Rand</span> <span style=color:#75af00>from</span> <span style=color:#d88200>&#34;rand-seed&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Make a 3D simplex noise generator to sync noise by timestamp between devices
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#00a8c8>const</span> <span style=color:#75af00>randomNumberGenerator</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>new</span> <span style=color:#75af00>Rand</span><span style=color:#111>(</span><span style=color:#d88200>&#34;identity&#34;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>getRandom</span> <span style=color:#f92672>=</span> <span style=color:#111>()</span> <span style=color:#111>=&gt;</span> <span style=color:#75af00>randomNumberGenerator</span><span style=color:#111>.</span><span style=color:#75af00>next</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>noiseGenerator</span> <span style=color:#f92672>=</span> <span style=color:#75af00>makeNoise3D</span><span style=color:#111>(</span><span style=color:#75af00>getRandom</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Create a wrapper for the global noise generator
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#00a8c8>export</span> <span style=color:#00a8c8>const</span> <span style=color:#75af00>getNoise</span> <span style=color:#f92672>=</span> <span style=color:#111>(</span><span style=color:#75af00>x</span><span style=color:#f92672>:</span> <span style=color:#75af00>number</span><span style=color:#111>,</span> <span style=color:#75af00>y</span><span style=color:#f92672>:</span> <span style=color:#75af00>number</span><span style=color:#111>,</span> <span style=color:#75af00>time</span><span style=color:#f92672>:</span> <span style=color:#75af00>number</span><span style=color:#111>)</span> <span style=color:#111>=&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>noiseGenerator</span><span style=color:#111>(</span><span style=color:#75af00>x</span><span style=color:#111>,</span> <span style=color:#75af00>y</span><span style=color:#111>,</span> <span style=color:#75af00>time</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>From here, another module can import the <code>getNoise</code> method to get a particular pixel of noise.</p><h2 id=conclusion>Conclusion</h2><p>Hopefully this will be useful or inspiring for your own future project!</p></div></div><script src=https://utteranc.es/client.js repo=We-Gold/We-Gold.github.io issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script></div></div><div class=container><div class="row justify-content-between"><div class=col-sm-4><p class=footer>Weaver Goldman Â© 2022</p></div><div class="col-sm-6 d-flex flex-row-reverse"><a class="footer-social px-2" href=https://github.com/We-Gold target=_blank><i class="fab fa-github"></i></a>
<a class="footer-social px-2" href=https://www.linkedin.com/in/weaver-goldman/ target=_blank><i class="fab fa-linkedin-in"></i></a></div></div></div><script src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/jquery.min.js></script>
<script src=/js/isotope.pkgd.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js integrity=sha384-GNFwBvfVxBkLMJpYMOABq3c+d3KnQxudP/mGPkzpZSTYykLBNsZEnG2D9G/X/+7D crossorigin=anonymous async></script>
<script src=/js/dark.js></script>
<script src=/js/isotope.js></script>
<script src=/js/mermaid.min.js></script>
<script>mermaid.initialize({startOnLoad:!0,securityLevel:"loose"})</script></body></html>